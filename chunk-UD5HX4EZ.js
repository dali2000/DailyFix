import{a as H,c as q,f as J,l as K,m as Q,n as X,r as Y,t as Z}from"./chunk-X2M4AGF3.js";import{$ as U,C as u,D as h,E,Ea as L,F as k,Fa as F,J as V,Ja as D,M as e,N as b,Q as y,Qa as j,R as M,S as f,U as _,W as n,Wa as W,X as r,Xa as A,Y as C,Ya as G,Za as R,_a as $,aa as v,ba as P,fa as N,ga as o,ha as s,ia as S,ja as B,na as O,oa as w,pa as I,ra as z,ta as a,ua as l,y as T}from"./chunk-72NXKA4U.js";function ee(p,x){if(p&1&&C(0,"img",47),p&2){let t=P();f("src",t.currentUser.profilePhoto,V)}}function te(p,x){if(p&1&&(n(0,"span",48),o(1),r()),p&2){let t=P();e(),s(t.userInitials)}}function ne(p,x){if(p&1&&(n(0,"option",49),o(1),r()),p&2){let t=x.$implicit;f("value",t.code),e(),S(" ",t.label," ")}}function ie(p,x){if(p&1&&(n(0,"option",49),o(1),r()),p&2){let t=x.$implicit;f("value",t.code),e(),B(" ",t.label," (",t.symbol,") ")}}function re(p,x){if(p&1&&(n(0,"p"),o(1),r()),p&2){let t=P();e(),B("",t.currentUser.fullName," \u2013 ",t.currentUser.email,"")}}function oe(p,x){p&1&&(n(0,"p"),o(1),a(2,"translate"),r()),p&2&&(e(),s(l(2,1,"common.loading")))}var ae=[{code:"fr",label:"Fran\xE7ais"},{code:"en",label:"English"},{code:"ar",label:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629 (\u062A\u0648\u0646\u0633)"}],xe=(()=>{class p{constructor(t,d,i,g,m){this.themeService=t,this.authService=d,this.currencyService=i,this.i18n=g,this.router=m,this.currentTheme="light",this.currentUser=null,this.profileFullName="",this.profileSaving=!1,this.selectedCurrencyCode="EUR",this.selectedLocale="fr",this.languages=ae}get currencies(){return this.currencyService.currencies}get userInitials(){if(!this.currentUser?.fullName)return"?";let t=String(this.currentUser.fullName).trim().split(/\s+/);return t.length>=2?(t[0][0]+t[t.length-1][0]).toUpperCase():this.currentUser.fullName.slice(0,2).toUpperCase()}onPhotoSelected(t){let d=t.target,i=d?.files?.[0];if(!i||!i.type.startsWith("image/"))return;let g=new FileReader;g.onload=()=>{let m=g.result;this.authService.updateProfile({profilePhoto:m}).subscribe({next:()=>{d.value=""},error:c=>console.error("Erreur lors de la mise \xE0 jour de la photo",c)})},g.readAsDataURL(i)}saveProfile(){let t=(this.profileFullName||"").trim();t.length<2||(this.profileSaving=!0,this.authService.updateProfile({fullName:t}).subscribe({next:()=>{this.profileSaving=!1},error:d=>{console.error("Erreur lors de la sauvegarde du profil",d),this.profileSaving=!1}}))}ngOnInit(){this.themeSubscription=this.themeService.theme$.subscribe(t=>{this.currentTheme=t}),this.userSubscription=this.authService.currentUser$.subscribe(t=>{this.currentUser=t,t&&(this.profileFullName=t.fullName||"",t.locale&&(this.selectedLocale=t.locale))}),this.selectedCurrencyCode=this.currencyService.getSelectedCurrencyCode(),this.currencySubscription=this.currencyService.selectedCurrency$.subscribe(t=>{this.selectedCurrencyCode=t}),this.selectedLocale=this.authService.getCurrentUser()?.locale||localStorage.getItem("dailyfix_locale")||"fr"}onLocaleChange(t){this.selectedLocale=t,this.i18n.use(t).subscribe();try{localStorage.setItem("dailyfix_locale",t)}catch{}this.authService.getCurrentUser()&&this.authService.updateProfile({locale:t}).subscribe({error:d=>console.error("Erreur lors de la sauvegarde de la langue",d)})}ngOnDestroy(){this.themeSubscription?.unsubscribe(),this.userSubscription?.unsubscribe(),this.currencySubscription?.unsubscribe()}onCurrencyChange(t){this.authService.getCurrentUser()?this.authService.updateProfile({currency:t}).subscribe({error:d=>console.error("Erreur lors de la sauvegarde de la devise",d)}):this.currencyService.setSelectedCurrency(t)}toggleTheme(){this.themeService.toggleTheme()}setTheme(t){this.themeService.setTheme(t),this.authService.getCurrentUser()&&this.authService.updateProfile({theme:t}).subscribe({error:d=>console.error("Erreur lors de la sauvegarde du th\xE8me",d)})}logout(){this.authService.logout(),this.router.navigate(["/login"])}static{this.\u0275fac=function(d){return new(d||p)(b(A),b(R),b(W),b(G),b(j))}}static{this.\u0275cmp=T({type:p,selectors:[["app-settings"]],standalone:!0,features:[z],decls:154,vars:121,consts:[["photoInput",""],[1,"settings-page"],[1,"settings-container"],[1,"settings-section","profile-section"],[1,"section-desc"],[1,"profile-card"],[1,"profile-avatar-wrap"],[1,"profile-avatar"],["alt","","class","avatar-img",3,"src",4,"ngIf"],["class","avatar-initials",4,"ngIf"],["type","file","accept","image/*",1,"profile-photo-input",3,"change"],["type","button",1,"btn","btn-secondary","btn-change-photo",3,"click"],[1,"profile-fields"],[1,"form-group"],["for","profile-fullName"],["id","profile-fullName","type","text","minlength","2",1,"form-input",3,"ngModelChange","ngModel","placeholder"],[1,"profile-email-readonly"],[1,"profile-email-hint"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"settings-section"],[1,"setting-item"],[1,"setting-info"],[1,"setting-control"],[1,"theme-toggle"],[1,"theme-option",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["cx","12","cy","12","r","5"],["x1","12","y1","1","x2","12","y2","3"],["x1","12","y1","21","x2","12","y2","23"],["x1","4.22","y1","4.22","x2","5.64","y2","5.64"],["x1","18.36","y1","18.36","x2","19.78","y2","19.78"],["x1","1","y1","12","x2","3","y2","12"],["x1","21","y1","12","x2","23","y2","12"],["x1","4.22","y1","19.78","x2","5.64","y2","18.36"],["x1","18.36","y1","5.64","x2","19.78","y2","4.22"],["d","M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"],["aria-label","Bleu",1,"theme-option",3,"click"],[2,"width","12px","height","12px","border-radius","999px","background","#2563eb"],["aria-label","For\xEAt",1,"theme-option",3,"click"],[2,"width","12px","height","12px","border-radius","999px","background","#15803d"],["aria-label","Violet",1,"theme-option",3,"click"],[2,"width","12px","height","12px","border-radius","999px","background","#7c3aed"],["id","locale-select",1,"currency-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["id","currency-select",1,"currency-select",3,"ngModelChange","ngModel"],[4,"ngIf"],[1,"btn","btn-danger",3,"click"],["alt","",1,"avatar-img",3,"src"],[1,"avatar-initials"],[3,"value"]],template:function(d,i){if(d&1){let g=U();n(0,"div",1)(1,"div",2)(2,"h1"),o(3),a(4,"translate"),r(),n(5,"section",3)(6,"h2"),o(7),a(8,"translate"),r(),n(9,"p",4),o(10),a(11,"translate"),r(),n(12,"div",5)(13,"div",6)(14,"div",7),y(15,ee,1,1,"img",8)(16,te,2,1,"span",9),r(),n(17,"input",10,0),a(19,"translate"),v("change",function(c){return u(g),h(i.onPhotoSelected(c))}),r(),n(20,"button",11),v("click",function(){u(g);let c=N(18);return h(c.click())}),o(21),a(22,"translate"),r()(),n(23,"div",12)(24,"div",13)(25,"label",14),o(26),a(27,"translate"),r(),n(28,"input",15),a(29,"translate"),I("ngModelChange",function(c){return u(g),w(i.profileFullName,c)||(i.profileFullName=c),h(c)}),r()(),n(30,"div",13)(31,"label"),o(32),a(33,"translate"),r(),n(34,"p",16),o(35),r(),n(36,"span",17),o(37),a(38,"translate"),r()(),n(39,"button",18),v("click",function(){return u(g),h(i.saveProfile())}),o(40),a(41,"translate"),a(42,"translate"),r()()()(),n(43,"section",19)(44,"h2"),o(45),a(46,"translate"),r(),n(47,"div",20)(48,"div",21)(49,"h3"),o(50),a(51,"translate"),r(),n(52,"p"),o(53),a(54,"translate"),r()(),n(55,"div",22)(56,"div",23)(57,"button",24),a(58,"translate"),v("click",function(){return u(g),h(i.setTheme("light"))}),E(),n(59,"svg",25),C(60,"circle",26)(61,"line",27)(62,"line",28)(63,"line",29)(64,"line",30)(65,"line",31)(66,"line",32)(67,"line",33)(68,"line",34),r(),k(),n(69,"span"),o(70),a(71,"translate"),r()(),n(72,"button",24),a(73,"translate"),v("click",function(){return u(g),h(i.setTheme("dark"))}),E(),n(74,"svg",25),C(75,"path",35),r(),k(),n(76,"span"),o(77),a(78,"translate"),r()(),n(79,"button",36),v("click",function(){return u(g),h(i.setTheme("blue"))}),C(80,"span",37),n(81,"span"),o(82),a(83,"translate"),r()(),n(84,"button",38),v("click",function(){return u(g),h(i.setTheme("forest"))}),C(85,"span",39),n(86,"span"),o(87),a(88,"translate"),r()(),n(89,"button",40),v("click",function(){return u(g),h(i.setTheme("purple"))}),C(90,"span",41),n(91,"span"),o(92),a(93,"translate"),r()()()()(),n(94,"div",20)(95,"div",21)(96,"h3"),o(97),a(98,"translate"),r(),n(99,"p"),o(100),a(101,"translate"),r()(),n(102,"div",22)(103,"select",42),I("ngModelChange",function(c){return u(g),w(i.selectedLocale,c)||(i.selectedLocale=c),h(c)}),v("ngModelChange",function(c){return u(g),h(i.onLocaleChange(c))}),y(104,ne,2,2,"option",43),r()()()(),n(105,"section",19)(106,"h2"),o(107),a(108,"translate"),r(),n(109,"div",20)(110,"div",21)(111,"h3"),o(112),a(113,"translate"),r(),n(114,"p"),o(115),a(116,"translate"),r()(),n(117,"div",22)(118,"select",44),I("ngModelChange",function(c){return u(g),w(i.selectedCurrencyCode,c)||(i.selectedCurrencyCode=c),h(c)}),v("ngModelChange",function(c){return u(g),h(i.onCurrencyChange(c))}),y(119,ie,2,3,"option",43),r()()()(),n(120,"section",19)(121,"h2"),o(122),a(123,"translate"),r(),n(124,"div",20)(125,"div",21)(126,"h3"),o(127),a(128,"translate"),r(),y(129,re,2,2,"p",45)(130,oe,3,3,"p",45),r()(),n(131,"div",20)(132,"div",21)(133,"h3"),o(134),a(135,"translate"),r(),n(136,"p"),o(137),a(138,"translate"),r()(),n(139,"div",22)(140,"button",46),v("click",function(){return u(g),h(i.logout())}),o(141),a(142,"translate"),r()()()(),n(143,"section",19)(144,"h2"),o(145),a(146,"translate"),r(),n(147,"div",20)(148,"div",21)(149,"h3"),o(150),a(151,"translate"),r(),n(152,"p"),o(153,"DailyFix v1.0.0"),r()()()()()()}d&2&&(e(3),s(l(4,55,"settings.title")),e(4),s(l(8,57,"settings.profile")),e(3),s(l(11,59,"settings.profileDesc")),e(4),_("has-photo",i.currentUser==null?null:i.currentUser.profilePhoto),e(),f("ngIf",i.currentUser==null?null:i.currentUser.profilePhoto),e(),f("ngIf",!(i.currentUser!=null&&i.currentUser.profilePhoto)),e(),M("aria-label",l(19,61,"settings.changePhoto")),e(4),S(" ",l(22,63,"settings.changePhoto")," "),e(5),s(l(27,65,"settings.fullNameLabel")),e(2),O("ngModel",i.profileFullName),f("placeholder",l(29,67,"settings.fullNameLabel")),e(4),s(l(33,69,"common.email")),e(3),s((i.currentUser==null?null:i.currentUser.email)||"\u2014"),e(2),s(l(38,71,"settings.emailNotEditable")),e(2),f("disabled",i.profileSaving),e(),S(" ",i.profileSaving?l(41,73,"common.loading"):l(42,75,"settings.saveProfile")," "),e(5),s(l(46,77,"settings.appearance")),e(5),s(l(51,79,"settings.theme")),e(3),s(l(54,81,"settings.themeDesc")),e(4),_("active",i.currentTheme==="light"),M("aria-label",l(58,83,"settings.themeLight")),e(13),s(l(71,85,"settings.themeLight")),e(2),_("active",i.currentTheme==="dark"),M("aria-label",l(73,87,"settings.themeDark")),e(5),s(l(78,89,"settings.themeDark")),e(2),_("active",i.currentTheme==="blue"),e(3),s(l(83,91,"settings.themeBlue")),e(2),_("active",i.currentTheme==="forest"),e(3),s(l(88,93,"settings.themeForest")),e(2),_("active",i.currentTheme==="purple"),e(3),s(l(93,95,"settings.themePurple")),e(5),s(l(98,97,"settings.language")),e(3),s(l(101,99,"settings.languageDesc")),e(3),O("ngModel",i.selectedLocale),e(),f("ngForOf",i.languages),e(3),s(l(108,101,"settings.wallet")),e(5),s(l(113,103,"settings.currency")),e(3),s(l(116,105,"settings.currencyDesc")),e(3),O("ngModel",i.selectedCurrencyCode),e(),f("ngForOf",i.currencies),e(3),s(l(123,107,"settings.account")),e(5),s(l(128,109,"settings.userInfo")),e(2),f("ngIf",i.currentUser),e(),f("ngIf",!i.currentUser),e(4),s(l(135,111,"nav.logout")),e(3),s(l(138,113,"settings.logoutDesc")),e(4),S(" ",l(142,115,"settings.logoutBtn")," "),e(4),s(l(146,117,"settings.about")),e(5),s(l(151,119,"settings.version")))},dependencies:[D,L,F,Z,Q,X,H,K,q,Y,J,$],styles:['.settings-page[_ngcontent-%COMP%]{padding:var(--notion-spacing-lg);max-width:800px;margin:0 auto;min-height:calc(100vh - 60px)}.settings-page[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:var(--notion-spacing-xl);font-size:32px;font-weight:700}.settings-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--notion-spacing-xl)}.settings-section[_ngcontent-%COMP%]{background:var(--notion-bg);border:1px solid var(--notion-border);border-radius:var(--notion-radius-md);padding:var(--notion-spacing-lg)}.settings-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin-bottom:var(--notion-spacing-lg);color:var(--notion-text-primary)}.section-desc[_ngcontent-%COMP%]{font-size:14px;color:var(--notion-text-secondary);margin:0 0 var(--notion-spacing-lg) 0}.profile-section[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--notion-spacing-xl);align-items:flex-start}.profile-avatar-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:var(--notion-spacing-md)}.profile-avatar[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;overflow:hidden;background:var(--notion-bg-tertiary);border:2px solid var(--notion-border);display:flex;align-items:center;justify-content:center;flex-shrink:0}.profile-avatar.has-photo[_ngcontent-%COMP%]{padding:0}.profile-avatar[_ngcontent-%COMP%]   .avatar-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block}.profile-avatar[_ngcontent-%COMP%]   .avatar-initials[_ngcontent-%COMP%]{font-size:32px;font-weight:600;color:var(--notion-text-primary);line-height:1}.profile-photo-input[_ngcontent-%COMP%]{position:absolute;width:0;height:0;opacity:0;overflow:hidden;clip:rect(0,0,0,0)}.profile-card[_ngcontent-%COMP%]   .btn-change-photo[_ngcontent-%COMP%]{margin-top:0}.profile-fields[_ngcontent-%COMP%]{flex:1;min-width:200px;display:flex;flex-direction:column;gap:var(--notion-spacing-md)}.profile-fields[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin:0}.profile-fields[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:600;color:var(--notion-text-primary);margin-bottom:6px}.profile-fields[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:100%;max-width:320px;padding:var(--notion-spacing-sm) var(--notion-spacing-md);border:1px solid var(--notion-border);border-radius:var(--notion-radius);background:var(--notion-bg);color:var(--notion-text-primary);font-size:14px}.profile-fields[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--notion-text-secondary);box-shadow:0 0 0 2px #0000000d}.profile-email-readonly[_ngcontent-%COMP%]{font-size:14px;color:var(--notion-text-primary);margin:4px 0 0;font-weight:500}.profile-email-hint[_ngcontent-%COMP%]{font-size:12px;color:var(--notion-text-tertiary);margin-top:4px;display:block}.profile-section[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-top:var(--notion-spacing-md)}.setting-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:var(--notion-spacing-md) 0;border-bottom:1px solid var(--notion-border)}.setting-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.setting-info[_ngcontent-%COMP%]{flex:1;margin-right:var(--notion-spacing-lg)}.setting-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:var(--notion-spacing-xs);color:var(--notion-text-primary)}.setting-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:var(--notion-text-secondary);margin:0}.setting-control[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--notion-spacing)}.currency-select[_ngcontent-%COMP%]{min-width:200px;padding:var(--notion-spacing-sm) var(--notion-spacing-md);border:1px solid var(--notion-border);border-radius:var(--notion-radius);background:var(--notion-bg);color:var(--notion-text-primary);font-size:14px}.theme-toggle[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--notion-spacing-sm);background:var(--notion-bg-secondary);border-radius:var(--notion-radius);padding:4px}.theme-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--notion-spacing-xs);padding:var(--notion-spacing-sm) var(--notion-spacing-md);border:none;background:transparent;border-radius:var(--notion-radius-sm);cursor:pointer;transition:all .2s ease;color:var(--notion-text-secondary);font-size:14px;font-weight:500;min-width:0}.theme-option[_ngcontent-%COMP%]:hover{background:var(--notion-bg-hover);color:var(--notion-text-primary)}.theme-option.active[_ngcontent-%COMP%]{background:var(--notion-text-primary);color:#929292!important}.dark-theme[_ngcontent-%COMP%]   .theme-option[_ngcontent-%COMP%]{color:var(--notion-text-primary)!important}.dark-theme[_ngcontent-%COMP%]   .theme-option[_ngcontent-%COMP%]:hover{background:var(--notion-bg-hover)!important;color:var(--notion-text-primary)!important}.dark-theme[_ngcontent-%COMP%]   .theme-option.active[_ngcontent-%COMP%]{background:#ffffff26!important;color:#fff!important}.theme-option[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px}@media (max-width: 768px){.settings-page[_ngcontent-%COMP%]{padding:var(--notion-spacing)}.settings-page[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}.settings-section[_ngcontent-%COMP%]{padding:var(--notion-spacing-md)}.settings-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;margin-bottom:var(--notion-spacing-md)}.setting-item[_ngcontent-%COMP%]{flex-direction:column;gap:var(--notion-spacing);align-items:stretch}.setting-info[_ngcontent-%COMP%]{margin-right:0}.setting-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px}.setting-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px}.setting-control[_ngcontent-%COMP%], .theme-toggle[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}.theme-option[_ngcontent-%COMP%]{flex:1 1 auto;min-width:80px;justify-content:center;padding:var(--notion-spacing-sm) var(--notion-spacing-sm);font-size:13px}.theme-option[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}.theme-option[_ngcontent-%COMP%]   span[style*="width: 12px"][_ngcontent-%COMP%]{width:10px!important;height:10px!important}.currency-select[_ngcontent-%COMP%]{min-width:0;width:100%;max-width:100%}}@media (max-width: 480px){.settings-page[_ngcontent-%COMP%]{padding:12px 16px}.settings-page[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:22px;margin-bottom:var(--notion-spacing-lg)}.settings-section[_ngcontent-%COMP%]{padding:14px}.settings-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:17px}.setting-item[_ngcontent-%COMP%]{padding:var(--notion-spacing-sm) 0}.theme-toggle[_ngcontent-%COMP%]{gap:8px;padding:6px}.theme-option[_ngcontent-%COMP%]{flex:1 1 calc(50% - 4px);min-width:0;padding:10px 8px;font-size:12px;justify-content:center}.theme-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:not([style*=width]){white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}.theme-option[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;height:14px;flex-shrink:0}.theme-option[_ngcontent-%COMP%]   span[style*="width: 12px"][_ngcontent-%COMP%]{width:8px!important;height:8px!important;flex-shrink:0}}@media (max-width: 360px){.theme-option[_ngcontent-%COMP%]{flex:1 1 100%}}']})}}return p})();export{ae as LANGUAGES,xe as SettingsComponent};
