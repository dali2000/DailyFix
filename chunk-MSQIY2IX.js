import{Ta as p,Xa as h,g as s,k as g,m as n,p as l,s as c}from"./chunk-AJ37PTJK.js";import{a,b as o}from"./chunk-POLL2CVR.js";var D=(()=>{class d{constructor(t,e){this.authService=t,this.apiService=e,this.events=[],this.suggestions=[{id:"1",title:"Randonn\xE9e en for\xEAt",description:"Profitez d'une belle journ\xE9e pour une randonn\xE9e en nature",category:"outdoor",estimatedCost:0,estimatedDuration:120},{id:"2",title:"Visite d'un mus\xE9e",description:"D\xE9couvrez l'art et l'histoire dans un mus\xE9e local",category:"cultural",estimatedCost:15,estimatedDuration:180},{id:"3",title:"Pique-nique au parc",description:"Un pique-nique simple et agr\xE9able avec des amis",category:"outdoor",estimatedCost:20,estimatedDuration:120},{id:"4",title:"S\xE9ance de cin\xE9ma",description:"Regardez un film au cin\xE9ma ou \xE0 la maison",category:"indoor",estimatedCost:12,estimatedDuration:150},{id:"5",title:"Cours de cuisine",description:"Apprenez \xE0 cuisiner un nouveau plat ensemble",category:"indoor",estimatedCost:30,estimatedDuration:120}],this.authService.currentUser$.pipe(g()).subscribe(i=>{i!==null?this.loadAll():this.events=[]})}getEvents(){return[...this.events]}getEventsObservable(){return this.apiService.get("/social/events").pipe(s(t=>t.data||[]),n(t=>this.events=t.map(e=>o(a({},e),{id:e.id.toString(),date:new Date(e.date),reminder:e.reminder?new Date(e.reminder):void 0}))))}getEventById(t){return this.events.find(e=>e.id===t)}getEventByIdObservable(t){return this.apiService.get(`/social/events/${t}`).pipe(s(e=>e.data))}addEvent(t){return this.apiService.post("/social/events",t).pipe(s(e=>e.data),n(e=>{this.events.push(o(a({},e),{id:e.id.toString(),date:new Date(e.date),reminder:e.reminder?new Date(e.reminder):void 0}))}))}updateEvent(t,e){return this.apiService.put(`/social/events/${t}`,e).pipe(s(i=>i.data),n(i=>{let r=this.events.findIndex(u=>u.id===t);r!==-1&&(this.events[r]=o(a({},i),{id:i.id.toString(),date:new Date(i.date),reminder:i.reminder?new Date(i.reminder):void 0}))}))}deleteEvent(t){return this.apiService.delete(`/social/events/${t}`).pipe(s(e=>e.success),n(()=>{let e=this.events.findIndex(i=>i.id===t);e!==-1&&this.events.splice(e,1)}))}getSuggestions(){return[...this.suggestions]}getSuggestionsObservable(){return this.apiService.get("/social/suggestions").pipe(s(t=>t.data||[]),n(t=>{t.length>0&&(this.suggestions=t.map(e=>o(a({},e),{id:e.id.toString()})))}))}addSuggestion(t){return this.apiService.post("/social/suggestions",t).pipe(s(e=>e.data),n(e=>{this.suggestions.push(o(a({},e),{id:e.id.toString()}))}))}updateSuggestion(t,e){return this.apiService.put(`/social/suggestions/${t}`,e).pipe(s(i=>i.data),n(i=>{let r=this.suggestions.findIndex(u=>u.id===t);r!==-1&&(this.suggestions[r]=o(a({},i),{id:i.id.toString()}))}))}deleteSuggestion(t){return this.apiService.delete(`/social/suggestions/${t}`).pipe(s(e=>e.success),n(()=>{let e=this.suggestions.findIndex(i=>i.id===t);e!==-1&&this.suggestions.splice(e,1)}))}getEventsForDate(t){let e=t.toDateString();return this.events.filter(i=>(i.date instanceof Date?i.date:new Date(i.date)).toDateString()===e)}getUpcomingEvents(){let t=new Date;return this.events.filter(e=>(e.date instanceof Date?e.date:new Date(e.date))>=t).sort((e,i)=>{let r=e.date instanceof Date?e.date:new Date(e.date),u=i.date instanceof Date?i.date:new Date(i.date);return r.getTime()-u.getTime()})}getBirthdays(){return this.events.filter(t=>t.type==="birthday")}getActivitySuggestions(){return this.getSuggestions()}addCustomSuggestion(t){return this.addSuggestion(t)}loadAll(){this.authService.isAuthenticated()?(this.getEventsObservable().subscribe({error:t=>console.error("Error loading social events:",t)}),this.getSuggestionsObservable().subscribe({error:t=>console.error("Error loading suggestions:",t)})):this.events=[]}static{this.\u0275fac=function(e){return new(e||d)(c(h),c(p))}}static{this.\u0275prov=l({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})();export{D as a};
