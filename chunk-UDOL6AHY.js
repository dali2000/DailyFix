import{Aa as g,a as r,b as n,m as c,p as h}from"./chunk-TB66C4D3.js";var f=(()=>{class l{constructor(t){this.authService=t,this.journalEntries=[],this.personalGoals=[],this.stressRecords=[],this.authService.currentUser$.subscribe(()=>{this.loadFromStorage()}),this.loadFromStorage()}getJournalEntries(){return[...this.journalEntries].sort((t,e)=>new Date(e.date).getTime()-new Date(t.date).getTime())}getJournalEntryById(t){return this.journalEntries.find(e=>e.id===t)}addJournalEntry(t){let e=n(r({},t),{id:this.generateId(),date:new Date});return this.journalEntries.push(e),this.saveToStorage(),e}updateJournalEntry(t,e){let s=this.journalEntries.findIndex(o=>o.id===t);return s===-1?null:(this.journalEntries[s]=r(r({},this.journalEntries[s]),e),this.saveToStorage(),this.journalEntries[s])}deleteJournalEntry(t){let e=this.journalEntries.findIndex(s=>s.id===t);return e===-1?!1:(this.journalEntries.splice(e,1),this.saveToStorage(),!0)}getPersonalGoals(){return[...this.personalGoals]}getPersonalGoalById(t){return this.personalGoals.find(e=>e.id===t)}addPersonalGoal(t){let e=n(r({},t),{id:this.generateId(),progress:0,completed:!1});return this.personalGoals.push(e),this.saveToStorage(),e}updatePersonalGoal(t,e){let s=this.personalGoals.findIndex(o=>o.id===t);return s===-1?null:(this.personalGoals[s]=r(r({},this.personalGoals[s]),e),e.progress!==void 0&&e.progress>=100&&(this.personalGoals[s].completed=!0),this.saveToStorage(),this.personalGoals[s])}deletePersonalGoal(t){let e=this.personalGoals.findIndex(s=>s.id===t);return e===-1?!1:(this.personalGoals.splice(e,1),this.saveToStorage(),!0)}getActiveGoals(){return this.personalGoals.filter(t=>!t.completed)}getCompletedGoals(){return this.personalGoals.filter(t=>t.completed)}getStressRecords(){return[...this.stressRecords].sort((t,e)=>new Date(e.date).getTime()-new Date(t.date).getTime())}addStressRecord(t){let e=n(r({},t),{id:this.generateId(),date:new Date});return this.stressRecords.push(e),this.saveToStorage(),e}getAverageStressLevel(t=7){let e=new Date;e.setDate(e.getDate()-t);let s=this.stressRecords.filter(i=>new Date(i.date)>=e);if(s.length===0)return 0;let o=s.reduce((i,u)=>i+u.stressLevel,0);return Math.round(o/s.length*10)/10}getStressManagementTips(){return["Pratiquez la respiration profonde pendant 5 minutes","Faites une promenade de 10 minutes","\xC9coutez de la musique apaisante","Essayez la m\xE9ditation guid\xE9e","Notez trois choses pour lesquelles vous \xEAtes reconnaissant","Faites des \xE9tirements l\xE9gers","Buvez un verre d'eau et prenez une pause","Appelez un ami ou un proche"]}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}saveToStorage(){let t=this.authService.getUserStorageKey("journal"),e=this.authService.getUserStorageKey("goals"),s=this.authService.getUserStorageKey("stress");localStorage.setItem(t,JSON.stringify(this.journalEntries)),localStorage.setItem(e,JSON.stringify(this.personalGoals)),localStorage.setItem(s,JSON.stringify(this.stressRecords))}loadFromStorage(){let t=this.authService.getUserStorageKey("journal"),e=this.authService.getUserStorageKey("goals"),s=this.authService.getUserStorageKey("stress"),o=localStorage.getItem(t),i=localStorage.getItem(e),u=localStorage.getItem(s);o&&(this.journalEntries=JSON.parse(o).map(a=>n(r({},a),{date:new Date(a.date)}))),i&&(this.personalGoals=JSON.parse(i).map(a=>n(r({},a),{targetDate:a.targetDate?new Date(a.targetDate):void 0,milestones:a.milestones?.map(d=>n(r({},d),{targetDate:d.targetDate?new Date(d.targetDate):void 0}))}))),u&&(this.stressRecords=JSON.parse(u).map(a=>n(r({},a),{date:new Date(a.date)})))}static{this.\u0275fac=function(e){return new(e||l)(h(g))}}static{this.\u0275prov=c({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();export{f as a};
