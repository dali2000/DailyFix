import{O as r,a as o,b as n}from"./chunk-X4VNRQJ7.js";var u=(()=>{class a{constructor(){this.shoppingLists=[],this.householdTasks=[],this.loadFromStorage()}getShoppingLists(){return[...this.shoppingLists]}getShoppingListById(s){return this.shoppingLists.find(t=>t.id===s)}addShoppingList(s){let t=n(o({},s),{id:this.generateId(),createdAt:new Date});return this.shoppingLists.push(t),this.saveToStorage(),t}updateShoppingList(s,t){let e=this.shoppingLists.findIndex(i=>i.id===s);return e===-1?null:(this.shoppingLists[e]=o(o({},this.shoppingLists[e]),t),this.saveToStorage(),this.shoppingLists[e])}deleteShoppingList(s){let t=this.shoppingLists.findIndex(e=>e.id===s);return t===-1?!1:(this.shoppingLists.splice(t,1),this.saveToStorage(),!0)}addItemToList(s,t){let e=this.getShoppingListById(s);if(!e)return null;let i=n(o({},t),{id:this.generateId()});return e.items.push(i),this.saveToStorage(),i}toggleItemPurchase(s,t){let e=this.getShoppingListById(s);if(!e)return!1;let i=e.items.find(h=>h.id===t);return i?(i.purchased=!i.purchased,this.saveToStorage(),!0):!1}getHouseholdTasks(){return[...this.householdTasks]}addHouseholdTask(s){let t=n(o({},s),{id:this.generateId()});return this.calculateNextDueDate(t),this.householdTasks.push(t),this.saveToStorage(),t}updateHouseholdTask(s,t){let e=this.householdTasks.findIndex(i=>i.id===s);return e===-1?null:(this.householdTasks[e]=o(o({},this.householdTasks[e]),t),t.completed&&(this.householdTasks[e].lastCompleted=new Date,this.calculateNextDueDate(this.householdTasks[e])),this.saveToStorage(),this.householdTasks[e])}deleteHouseholdTask(s){let t=this.householdTasks.findIndex(e=>e.id===s);return t===-1?!1:(this.householdTasks.splice(t,1),this.saveToStorage(),!0)}getUpcomingHouseholdTasks(){let s=new Date;return this.householdTasks.filter(t=>!t.completed&&t.nextDueDate&&new Date(t.nextDueDate)>=s).sort((t,e)=>{let i=t.nextDueDate?new Date(t.nextDueDate).getTime():0,h=e.nextDueDate?new Date(e.nextDueDate).getTime():0;return i-h})}calculateNextDueDate(s){if(s.frequency==="one-time"&&s.dueDate){s.nextDueDate=s.dueDate;return}let t=s.lastCompleted||new Date,e=new Date(t);switch(s.frequency){case"daily":e.setDate(e.getDate()+1);break;case"weekly":e.setDate(e.getDate()+7);break;case"monthly":e.setMonth(e.getMonth()+1);break}s.nextDueDate=e}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}saveToStorage(){localStorage.setItem("dailyFix_shoppingLists",JSON.stringify(this.shoppingLists)),localStorage.setItem("dailyFix_householdTasks",JSON.stringify(this.householdTasks))}loadFromStorage(){let s=localStorage.getItem("dailyFix_shoppingLists"),t=localStorage.getItem("dailyFix_householdTasks");s&&(this.shoppingLists=JSON.parse(s).map(e=>n(o({},e),{createdAt:new Date(e.createdAt)}))),t&&(this.householdTasks=JSON.parse(t).map(e=>n(o({},e),{dueDate:e.dueDate?new Date(e.dueDate):void 0,lastCompleted:e.lastCompleted?new Date(e.lastCompleted):void 0,nextDueDate:e.nextDueDate?new Date(e.nextDueDate):void 0})))}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275prov=r({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{u as a};
