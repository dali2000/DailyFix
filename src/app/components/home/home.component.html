<div class="home-page">
  <h1>{{ 'home.greeting' | translate }} {{ userName || ('common.user' | translate) }} ! ğŸ‘‹</h1>
  <p>{{ 'home.ready' | translate }}</p>


  <div class="cards-container">
    <!-- Task Card -->
    <div class="stats-card blue">
      <div class="card-header">
        <span>{{ 'home.todayTasks' | translate }}</span>
        <i class="bi bi-check2-circle"></i>
      </div>
      <div class="card-value">{{ todayHouseholdTasksCount + shoppingListsCount }}</div>
      <div class="card-subtitle" *ngIf="todayHouseholdTasksCount > 0 || shoppingListsCount > 0">
        <span *ngIf="todayHouseholdTasksCount > 0">{{ todayHouseholdTasksCount }} {{ 'home.householdTasks' | translate }}</span>
        <span *ngIf="todayHouseholdTasksCount > 0 && shoppingListsCount > 0"> â€¢ </span>
        <span *ngIf="shoppingListsCount > 0">{{ shoppingListsCount }} {{ 'home.shoppingLists' | translate }}</span>
      </div>
      <div class="card-subtitle" *ngIf="todayHouseholdTasksCount === 0 && shoppingListsCount === 0">
        {{ 'home.noTasksOrLists' | translate }}
      </div>
    </div>

    <!-- Health Score Card -->
    <div class="stats-card green">
      <div class="card-header">
        <span>{{ 'home.healthScore' | translate }}</span>
        <i class="bi bi-heart"></i>
      </div>
      <div class="card-value">{{ healthScore }}%</div>
    </div>

    <!-- Budget Card -->
    <div class="stats-card purple">
      <div class="card-header">
        <span>{{ 'home.remainingBalance' | translate }}</span>
        <i class="bi bi-currency-dollar"></i>
      </div>
      <div class="card-value" [class.negative]="remainingBalance < 0">{{ currencySymbol }}{{ remainingBalance | number:'1.0-0' }}</div>
    </div>

    <!-- Events Card -->
    <div class="stats-card orange">
      <div class="card-header">
        <span>{{ 'home.events' | translate }}</span>
        <i class="bi bi-calendar-event"></i>
      </div>
      <div class="card-value">{{ upcomingEventsCount }}</div>
    </div>
  </div>

  <br><br><br>
  <div class="dashboard">
    <!-- Gestion des tÃ¢ches -->
    <div class="card">
      <div class="card-header">
        <div class="icon blue1">âœ”</div>
        <div>
          <h3>{{ 'home.taskManagement' | translate }}</h3>
          <small>{{ 'home.taskManagementDesc' | translate }}</small>
        </div>
      </div>
      <div>
        <span>{{ 'home.completedToday' | translate }} {{ tasksCompletedToday }}/{{ totalTasks }} ({{ 'home.total' | translate }}: {{ tasksCompleted }})</span>
        <div class="progress">
          <div class="progress-bar" [style.width.%]="totalTasks ? (tasksCompleted / totalTasks) * 100 : 0"></div>
        </div>
        <button (click)="navigateTo('/tasks')">{{ 'home.manageTasks' | translate }}</button>
      </div>
    </div>

    <!-- Suivi SantÃ© -->
    <div class="card">
      <div class="card-header">
        <div class="icon green1">â¤</div>
        <div>
          <h3>{{ 'home.healthTracking' | translate }}</h3>
          <small>{{ 'home.healthTrackingDesc' | translate }}</small>
        </div>
      </div>
      <p>{{ 'home.mealsToday' | translate }}: {{ todayMealsCount }} ({{ todayCalories }} kcal)</p>
      <p>{{ 'home.waterConsumed' | translate }}: {{ todayWaterLiters | number:'1.1-1' }} L</p>
      <p>{{ 'home.activity' | translate }}: {{ todayActivityMinutes }} min</p>
      <p>{{ 'home.lastSleep' | translate }}: {{ lastSleepHours != null ? (lastSleepHours + 'h') : 'â€”' }}</p>
      <button (click)="navigateTo('/health')">{{ 'home.updateHealth' | translate }}</button>
    </div>

    <!-- Finances -->
    <div class="card">
      <div class="card-header">
        <div class="icon purple1">ğŸ’²</div>
        <div>
          <h3>{{ 'home.finances' | translate }}</h3>
          <small>{{ 'home.financesDesc' | translate }}</small>
        </div>
      </div>
      <p>{{ 'home.expensesThisMonth' | translate }}: {{ currencySymbol }}{{ monthlyExpenses | number:'1.0-0' }}</p>
      <p [class.green-text]="remainingBalance >= 0" [class.red-text]="remainingBalance < 0">
        {{ 'home.remainingBalance' | translate }}: {{ currencySymbol }}{{ remainingBalance | number:'1.0-0' }}
      </p>
      <div class="progress">
        <div class="progress-bar grey1"></div>
      </div>
      <button (click)="navigateTo('/finance')">{{ 'home.addExpense' | translate }}</button>
    </div>

    <!-- Organisation Domestique -->
    <div class="card">
      <div class="card-header">
        <div class="icon yellow1">ğŸ </div>
        <div>
          <h3>{{ 'home.domesticOrg' | translate }}</h3>
          <small>{{ 'home.domesticOrgDesc' | translate }}</small>
        </div>
      </div>
      <ul>
        <li *ngFor="let task of upcomingHouseTasks">
          {{task.name}} {{task.date}}
        </li>
      </ul>
      <button (click)="navigateTo('/home-org')">{{ 'home.planTask' | translate }}</button>
    </div>

    <!-- Ã‰vÃ©nements Sociaux -->
    <div class="card">
      <div class="card-header">
        <div class="icon orange1">ğŸ“…</div>
        <div>
          <h3>{{ 'home.socialEvents' | translate }}</h3>
          <small>{{ 'home.socialEventsDesc' | translate }}</small>
        </div>
      </div>
      <ul>
        <li *ngFor="let event of upcomingEvents">
          {{event.name}} {{event.date}}
        </li>
      </ul>
      <button (click)="navigateTo('/social')">{{ 'home.newEvent' | translate }}</button>
    </div>

    <!-- DÃ©veloppement Personnel -->
    <div class="card">
      <div class="card-header">
        <div class="icon violet1">ğŸ¯</div>
        <div>
          <h3>{{ 'home.personalDev' | translate }}</h3>
          <small>{{ 'home.personalDevDesc' | translate }}</small>
        </div>
      </div>
      <ul>
        <li *ngFor="let goal of personalGoals">
          {{goal.name}} <span [class.done]="goal.done">âœ”</span>
        </li>
      </ul>
      <button (click)="navigateTo('/wellness')">{{ 'home.newGoal' | translate }}</button>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="charts-section">
    <!-- Tasks Chart -->
    <div class="chart-card">
      <div class="chart-header">
        <h3>ğŸ“Š {{ 'home.taskProgress' | translate }}</h3>
      </div>
      <div class="chart-content">
        <div class="task-status-chart">
          <div *ngFor="let item of taskStatusData" class="status-bar-item">
            <div class="status-label">
              <span>{{ item.status }}</span>
              <span class="status-count">{{ item.count }}</span>
            </div>
            <div class="status-bar">
              <div class="status-bar-fill" [style.width.%]="item.percentage" [class]="'status-' + item.status.toLowerCase().replace(' ', '-')"></div>
            </div>
            <span class="status-percentage">{{ item.percentage | number:'1.0-0' }}%</span>
          </div>
        </div>
        <div class="task-progress-circle">
          <div class="progress-circle" [style.--progress]="taskProgressPercentage + '%'">
            <svg viewBox="0 0 100 100">
              <circle cx="50" cy="50" r="45" class="progress-bg"></circle>
              <circle cx="50" cy="50" r="45" class="progress-fill" [style.stroke-dashoffset]="283 - (283 * taskProgressPercentage / 100)"></circle>
            </svg>
            <div class="progress-text">
              <span class="progress-value">{{ taskProgressPercentage | number:'1.0-0' }}%</span>
              <span class="progress-label">{{ 'home.completed' | translate }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Finance Chart -->
    <div class="chart-card">
      <div class="chart-header">
        <h3>ğŸ’° DÃ©penses par CatÃ©gorie</h3>
      </div>
      <div class="chart-content">
        <div class="expense-category-chart">
          <div *ngFor="let item of expenseCategoryData" class="category-bar-item">
            <div class="category-label">
              <span>{{ item.category }}</span>
              <span class="category-amount">{{ currencySymbol }}{{ item.amount | number:'1.0-0' }}</span>
            </div>
            <div class="category-bar">
              <div class="category-bar-fill" [style.width.%]="item.percentage"></div>
            </div>
            <span class="category-percentage">{{ item.percentage | number:'1.0-0' }}%</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Monthly Expense History -->
    <div class="chart-card">
      <div class="chart-header">
        <h3>ğŸ“ˆ {{ 'home.expenseEvolution' | translate }}</h3>
      </div>
      <div class="chart-content">
        <div class="expense-history-chart">
          <div class="history-bars">
            <div *ngFor="let item of monthlyExpenseHistory" class="history-bar-item">
              <div class="history-bar" [style.height.%]="getMaxExpense() > 0 ? (item.amount / getMaxExpense()) * 100 : 0">
                <span class="history-amount">{{ currencySymbol }}{{ item.amount | number:'1.0-0' }}</span>
              </div>
              <span class="history-month">{{ item.month }}</span>
            </div>
          </div>
          <div *ngIf="monthlyExpenseHistory.length === 0" class="no-data">
            <p>{{ 'common.noData' | translate }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- App Statistics -->
  <div class="stats-section">
    <h2>ğŸ“ˆ {{ 'home.appStats' | translate }}</h2>
    <div class="stats-grid">
      <div class="stat-item">
        <div class="stat-icon">ğŸ’¸</div>
        <div class="stat-info">
          <div class="stat-label">{{ 'home.totalExpenses' | translate }}</div>
          <div class="stat-value">{{ currencySymbol }}{{ totalExpenses | number:'1.0-0' }}</div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">ğŸ¯</div>
        <div class="stat-info">
          <div class="stat-label">{{ 'home.savingsGoals' | translate }}</div>
          <div class="stat-value">{{ totalSavingsGoals }}</div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">âœ…</div>
        <div class="stat-info">
          <div class="stat-label">{{ 'home.activeGoals' | translate }}</div>
          <div class="stat-value">{{ activeSavingsGoals }}</div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">â¤ï¸</div>
        <div class="stat-info">
          <div class="stat-label">{{ 'home.healthRecords' | translate }}</div>
          <div class="stat-value">{{ totalHealthRecords }}</div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">ğŸ“…</div>
        <div class="stat-info">
          <div class="stat-label">{{ 'home.socialEventsCount' | translate }}</div>
          <div class="stat-value">{{ totalSocialEvents }}</div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">âœ“</div>
        <div class="stat-info">
          <div class="stat-label">{{ 'home.totalTasks' | translate }}</div>
          <div class="stat-value">{{ totalTasks }}</div>
        </div>
      </div>
    </div>
  </div>
</div>
