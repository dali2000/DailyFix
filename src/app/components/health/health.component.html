<div class="health-page">
  <h1>Suivi de la Sant√© et du Bien-√™tre</h1>

  <div class="tabs">
    <button [class.active]="activeTab === 'overview'" (click)="activeTab = 'overview'">Vue d'ensemble</button>
    <button [class.active]="activeTab === 'meals'" (click)="activeTab = 'meals'">Alimentation</button>
    <button [class.active]="activeTab === 'activity'" (click)="activeTab = 'activity'">Activit√© physique</button>
    <button [class.active]="activeTab === 'sleep'" (click)="activeTab = 'sleep'">Sommeil</button>
    <button [class.active]="activeTab === 'meditation'" (click)="activeTab = 'meditation'">M√©ditation</button>
  </div>

  <!-- Overview Tab -->
  <div *ngIf="activeTab === 'overview'" class="tab-content">
    <div class="health-score-card">
      <h2>Score de Sant√©</h2>
      <div class="score-circle">
        <span class="score-value">{{ getHealthScore() }}%</span>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <h3>Calories aujourd'hui</h3>
        <p class="stat-value">{{ todayCalories }} kcal</p>
        <small>Objectif: 2000 kcal</small>
      </div>
      <div class="stat-card">
        <h3>Activit√© physique</h3>
        <p class="stat-value">{{ todayActivityMinutes }} min</p>
        <small>Objectif: 30 min/jour</small>
      </div>
      <div class="stat-card">
        <h3>Eau consomm√©e</h3>
        <p class="stat-value">{{ todayWaterIntake }}L</p>
        <small>Objectif: 2L/jour</small>
      </div>
      <div class="stat-card">
        <h3>Sommeil (derni√®re nuit)</h3>
        <p class="stat-value">{{ lastSleepHours }}h</p>
        <small>Recommand√©: 7-9h</small>
      </div>
    </div>
  </div>

  <!-- Meals Tab -->
  <div *ngIf="activeTab === 'meals'" class="tab-content">
    <div class="section-header">
      <h2>Suivi Alimentaire</h2>
      <button type="button" class="btn btn-primary" (click)="showMealForm = true">+ Ajouter un repas</button>
    </div>

    <div class="meals-list">
      <div *ngFor="let meal of meals.slice().reverse()" class="meal-card">
        <div class="meal-header">
          <h4>{{ meal.name }}</h4>
          <span class="meal-type">{{ meal.type }}</span>
        </div>
        <p *ngIf="meal.calories" class="calories">{{ meal.calories }} kcal</p>
        <p *ngIf="meal.notes" class="notes">{{ meal.notes }}</p>
        <small>{{ meal.date | date:'short' }}</small>
        <button class="btn btn-small btn-danger" (click)="deleteMeal(meal.id)">Supprimer</button>
      </div>
    </div>
  </div>

  <!-- Activity Tab -->
  <div *ngIf="activeTab === 'activity'" class="tab-content">
    <div class="section-header">
      <h2>Activit√© Physique</h2>
      <button type="button" class="btn btn-primary" (click)="showActivityForm = true">+ Ajouter une activit√©</button>
    </div>

    <div class="activities-list">
      <div *ngFor="let activity of activities.slice().reverse()" class="activity-card">
        <h4>{{ activity.type }}</h4>
        <p class="duration">{{ activity.duration }} minutes</p>
        <p *ngIf="activity.calories" class="calories">{{ activity.calories }} kcal br√ªl√©es</p>
        <p *ngIf="activity.notes" class="notes">{{ activity.notes }}</p>
        <small>{{ activity.date | date:'short' }}</small>
        <button class="btn btn-small btn-danger" (click)="deleteActivity(activity.id)">Supprimer</button>
      </div>
    </div>
  </div>

  <!-- Sleep Tab -->
  <div *ngIf="activeTab === 'sleep'" class="tab-content">
    <div class="section-header">
      <h2>Suivi du Sommeil</h2>
      <button type="button" class="btn btn-primary" (click)="showSleepForm = true">+ Enregistrer le sommeil</button>
    </div>

    <div class="sleep-records">
      <div *ngFor="let record of sleepRecords.slice().reverse()" class="sleep-card">
        <h4>{{ record.hours }} heures de sommeil</h4>
        <p>Coucher: {{ record.sleepTime | date:'short' }}</p>
        <p>R√©veil: {{ record.wakeTime | date:'short' }}</p>
        <p>Qualit√©: {{ record.quality }}</p>
        <small>{{ record.date | date:'short' }}</small>
      </div>
    </div>
  </div>

  <!-- Meditation Tab -->
  <div *ngIf="activeTab === 'meditation'" class="tab-content">
    <div class="section-header">
      <h2>M√©ditation et Relaxation</h2>
      <button type="button" class="btn btn-primary" (click)="showMeditationForm = true">+ Nouvelle session</button>
    </div>

    <div class="meditation-sessions">
      <div *ngFor="let session of meditationSessions.slice().reverse()" class="meditation-card">
        <h4>{{ session.type }}</h4>
        <p class="duration">{{ session.duration }} minutes</p>
        <p *ngIf="session.notes" class="notes">{{ session.notes }}</p>
        <small>{{ session.date | date:'short' }}</small>
      </div>
    </div>
  </div>

  <!-- Water Intake -->
  <div class="water-quick-add">
    <button type="button" class="btn btn-secondary" (click)="showWaterForm = true">
      üíß Ajouter de l'eau
    </button>
  </div>

  <!-- Health Modals -->
  <app-modal *ngIf="showMealForm" title="Nouveau repas" size="md" (closeModal)="closeMealModal()">
    <form (ngSubmit)="addMeal()">
      <div class="form-group">
        <label>Nom du repas *</label>
        <input type="text" [(ngModel)]="newMeal.name" name="name" required>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Type</label>
          <select [(ngModel)]="newMeal.type" name="type">
            <option value="breakfast">Petit-d√©jeuner</option>
            <option value="lunch">D√©jeuner</option>
            <option value="dinner">D√Æner</option>
            <option value="snack">Collation</option>
          </select>
        </div>
        <div class="form-group">
          <label>Calories</label>
          <input type="number" [(ngModel)]="newMeal.calories" name="calories">
        </div>
      </div>
      <div class="form-group">
        <label>Notes</label>
        <textarea [(ngModel)]="newMeal.notes" name="notes" rows="2"></textarea>
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="closeMealModal()">Annuler</button>
        <button type="submit" class="btn btn-primary">Ajouter</button>
      </div>
    </form>
  </app-modal>

  <app-modal *ngIf="showActivityForm" title="Nouvelle activit√©" size="md" (closeModal)="closeActivityModal()">
    <form (ngSubmit)="addActivity()">
      <div class="form-group">
        <label>Type d'activit√© *</label>
        <input type="text" [(ngModel)]="newActivity.type" name="type" placeholder="ex: Course, Natation, Yoga" required>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Dur√©e (minutes) *</label>
          <input type="number" [(ngModel)]="newActivity.duration" name="duration" required>
        </div>
        <div class="form-group">
          <label>Calories br√ªl√©es</label>
          <input type="number" [(ngModel)]="newActivity.calories" name="calories">
        </div>
      </div>
      <div class="form-group">
        <label>Notes</label>
        <textarea [(ngModel)]="newActivity.notes" name="notes" rows="2"></textarea>
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="closeActivityModal()">Annuler</button>
        <button type="submit" class="btn btn-primary">Ajouter</button>
      </div>
    </form>
  </app-modal>

  <app-modal *ngIf="showSleepForm" title="Enregistrer le sommeil" size="md" (closeModal)="closeSleepModal()">
    <form (ngSubmit)="addSleepRecord()">
      <div class="form-row">
        <div class="form-group">
          <label>Heure de coucher *</label>
          <input type="datetime-local" [(ngModel)]="newSleep.sleepTime" name="sleepTime" required>
        </div>
        <div class="form-group">
          <label>Heure de r√©veil *</label>
          <input type="datetime-local" [(ngModel)]="newSleep.wakeTime" name="wakeTime" required>
        </div>
      </div>
      <div class="form-group">
        <label>Qualit√© du sommeil</label>
        <select [(ngModel)]="newSleep.quality" name="quality">
          <option value="poor">Mauvaise</option>
          <option value="fair">Moyenne</option>
          <option value="good">Bonne</option>
          <option value="excellent">Excellente</option>
        </select>
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="closeSleepModal()">Annuler</button>
        <button type="submit" class="btn btn-primary">Enregistrer</button>
      </div>
    </form>
  </app-modal>

  <app-modal *ngIf="showMeditationForm" title="Nouvelle session de m√©ditation" size="sm" (closeModal)="closeMeditationModal()">
    <form (ngSubmit)="addMeditationSession()">
      <div class="form-row">
        <div class="form-group">
          <label>Dur√©e (minutes)</label>
          <input type="number" [(ngModel)]="newMeditation.duration" name="duration">
        </div>
        <div class="form-group">
          <label>Type</label>
          <select [(ngModel)]="newMeditation.type" name="type">
            <option value="guided">Guid√©e</option>
            <option value="breathing">Respiration</option>
            <option value="mindfulness">Pleine conscience</option>
            <option value="body-scan">Balayage corporel</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <label>Notes</label>
        <textarea [(ngModel)]="newMeditation.notes" name="notes" rows="2"></textarea>
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="closeMeditationModal()">Annuler</button>
        <button type="submit" class="btn btn-primary">Enregistrer</button>
      </div>
    </form>
  </app-modal>

  <app-modal *ngIf="showWaterForm" title="Ajouter de l'eau" size="sm" (closeModal)="closeWaterModal()">
    <form (ngSubmit)="addWaterIntake()">
      <div class="form-group">
        <label>Quantit√© (litres)</label>
        <input type="number" [(ngModel)]="waterAmount" name="waterAmount" step="0.25" min="0.25" max="2">
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="closeWaterModal()">Annuler</button>
        <button type="submit" class="btn btn-primary">Ajouter</button>
      </div>
    </form>
  </app-modal>
</div>


