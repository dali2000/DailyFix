import{a as L,b as w,c as B,d as z,g as V,j as N,k as F,q as H,r as j,s as q,u as A}from"./chunk-54QNWKKZ.js";import{A as P,Ca as k,Ga as I,J as n,K as u,La as S,N as x,Na as O,Oa as E,P as l,Ra as R,T as i,U as o,V as b,Xa as T,Y as M,Ya as G,Z as C,_ as g,da as r,ea as p,fa as v,oa as y,qa as a,ra as s,v as h,z as _}from"./chunk-XXCCQEXG.js";import"./chunk-POLL2CVR.js";function D(e,m){if(e&1&&(i(0,"p",9),r(1),o()),e&2){let t=g();n(),p(t.errorMessage)}}function U(e,m){e&1&&(i(0,"p",10)(1,"a",11),r(2),a(3,"translate"),o()()),e&2&&(n(2),p(s(3,1,"forgotPassword.backToLogin")))}function J(e,m){e&1&&(i(0,"div",21),r(1),a(2,"translate"),o()),e&2&&(n(),v(" ",s(2,1,"login.passwordError")," "))}function K(e,m){e&1&&(i(0,"div",22),r(1),a(2,"translate"),o()),e&2&&(n(),v(" ",s(2,1,"resetPassword.passwordMismatch")," "))}function Q(e,m){if(e&1&&(i(0,"p",23),r(1),o()),e&2){let t=g(2);n(),p(t.successMessage)}}function W(e,m){if(e&1&&(i(0,"p",9),r(1),o()),e&2){let t=g(2);n(),p(t.errorMessage)}}function X(e,m){if(e&1){let t=M();i(0,"form",12),C("ngSubmit",function(){_(t);let d=g();return P(d.submit())}),i(1,"label",13),r(2),a(3,"translate"),o(),b(4,"input",14),x(5,J,3,3,"div",15),i(6,"label",16),r(7),a(8,"translate"),o(),b(9,"input",17),x(10,K,3,3,"div",18)(11,Q,2,1,"p",19)(12,W,2,1,"p",6),i(13,"button",20),r(14),a(15,"translate"),a(16,"translate"),o()()}if(e&2){let t=g();l("formGroup",t.form),n(2),p(s(3,9,"resetPassword.newPassword")),n(3),l("ngIf",t.form.controls.newPassword.touched&&t.form.controls.newPassword.invalid),n(2),p(s(8,11,"resetPassword.confirmPassword")),n(3),l("ngIf",t.form.controls.confirmPassword.touched&&t.form.getError("passwordMismatch")),n(),l("ngIf",t.successMessage),n(),l("ngIf",t.errorMessage),n(),l("disabled",t.isLoading),n(),v(" ",t.isLoading?s(15,13,"common.loading"):s(16,15,"resetPassword.submit")," ")}}function Y(e,m){e&1&&(i(0,"p",10)(1,"a",11),r(2),a(3,"translate"),o()()),e&2&&(n(2),p(s(3,1,"forgotPassword.backToLogin")))}var se=(()=>{class e{constructor(t,c,d,f){this.fb=t,this.authService=c,this.router=d,this.route=f,this.token=null,this.isLoading=!1,this.successMessage=null,this.errorMessage=null,this.form=this.fb.group({newPassword:["",[w.required,w.minLength(6)]],confirmPassword:["",[w.required]]},{validators:this.passwordMatchValidator})}passwordMatchValidator(t){let c=t,d=c.get("newPassword")?.value,f=c.get("confirmPassword")?.value;return f&&d!==f?{passwordMismatch:!0}:null}ngOnInit(){this.token=this.route.snapshot.queryParamMap.get("token"),this.token||(this.errorMessage="Lien invalide. Veuillez redemander une r\xE9initialisation.")}submit(){if(this.form.invalid||!this.token){this.form.markAllAsTouched();return}this.errorMessage=null,this.successMessage=null,this.isLoading=!0,this.authService.resetPassword(this.token,this.form.value.newPassword).subscribe({next:t=>{this.isLoading=!1,this.successMessage=t.message??"Mot de passe mis \xE0 jour.",setTimeout(()=>this.router.navigate(["/login"]),2500)},error:t=>{this.isLoading=!1,this.errorMessage=t?.error?.message??"Lien invalide ou expir\xE9."}})}backToLogin(){this.router.navigate(["/login"])}static{this.\u0275fac=function(c){return new(c||e)(u(q),u(T),u(O),u(S))}}static{this.\u0275cmp=h({type:e,selectors:[["app-reset-password"]],standalone:!0,features:[y],decls:18,vars:16,consts:[[1,"auth-page"],[1,"brand"],[1,"subtitle"],["aria-label","R\xE9initialiser le mot de passe",1,"card"],[1,"title"],[1,"subtext"],["class","error-message",4,"ngIf"],["class","back-link",4,"ngIf"],["novalidate","",3,"formGroup","ngSubmit",4,"ngIf"],[1,"error-message"],[1,"back-link"],["routerLink","/login"],["novalidate","",3,"ngSubmit","formGroup"],["for","newPassword"],["id","newPassword","type","password","formControlName","newPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","autocomplete","new-password","required","","minlength","6","aria-describedby","newPasswordHelp"],["id","newPasswordHelp","class","error",4,"ngIf"],["for","confirmPassword"],["id","confirmPassword","type","password","formControlName","confirmPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","autocomplete","new-password","required","","aria-describedby","confirmHelp"],["id","confirmHelp","class","error",4,"ngIf"],["class","success-message",4,"ngIf"],["type","submit",1,"submit","btn","btn-primary",3,"disabled"],["id","newPasswordHelp",1,"error"],["id","confirmHelp",1,"error"],[1,"success-message"]],template:function(c,d){c&1&&(i(0,"div",0)(1,"h1",1),r(2),a(3,"translate"),o(),i(4,"p",2),r(5),a(6,"translate"),o(),i(7,"section",3)(8,"h2",4),r(9),a(10,"translate"),o(),i(11,"p",5),r(12),a(13,"translate"),o(),x(14,D,2,1,"p",6)(15,U,4,3,"p",7)(16,X,17,17,"form",8)(17,Y,4,3,"p",7),o()()),c&2&&(n(2),p(s(3,8,"login.brand")),n(3),p(s(6,10,"resetPassword.subtitle")),n(4),p(s(10,12,"resetPassword.title")),n(3),p(s(13,14,"resetPassword.desc")),n(2),l("ngIf",!d.token&&d.errorMessage),n(),l("ngIf",!d.token),n(),l("ngIf",d.token),n(),l("ngIf",d.token&&!d.successMessage))},dependencies:[I,k,A,V,L,B,z,H,j,N,F,R,E,G],styles:["[_nghost-%COMP%]{display:block}.auth-page[_ngcontent-%COMP%]{min-height:100vh;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--notion-spacing-2xl) var(--notion-spacing-lg);background:var(--notion-bg-secondary);font-family:ui-sans-serif,-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;overflow-x:hidden;box-sizing:border-box}.brand[_ngcontent-%COMP%]{font-size:40px;font-weight:700;color:var(--notion-text-primary);margin:0 0 8px;text-align:center;letter-spacing:-.03em}.subtitle[_ngcontent-%COMP%]{color:var(--notion-text-secondary);margin:0 0 var(--notion-spacing-2xl) 0;text-align:center;font-size:14px}.card[_ngcontent-%COMP%]{width:100%;max-width:400px;background:var(--notion-bg);border:1px solid var(--notion-border);border-radius:var(--notion-radius);box-shadow:var(--notion-shadow);padding:var(--notion-spacing-xl)}.title[_ngcontent-%COMP%]{text-align:center;font-size:24px;margin:0 0 4px;color:var(--notion-text-primary);font-weight:600;letter-spacing:-.02em}.subtext[_ngcontent-%COMP%]{text-align:center;color:var(--notion-text-tertiary);margin:0 0 var(--notion-spacing-lg);font-size:14px}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--notion-spacing-lg)}label[_ngcontent-%COMP%]{font-size:12px;color:var(--notion-text-secondary);font-weight:500;margin-bottom:4px;text-transform:uppercase;letter-spacing:.5px}input[_ngcontent-%COMP%]{width:100%;padding:6px 8px;border-radius:var(--notion-radius);border:1px solid var(--notion-border);background:var(--notion-bg);font-size:14px;outline:none;transition:border-color 20ms ease-in 0s;font-family:inherit}input[_ngcontent-%COMP%]:focus{border-color:var(--notion-blue);box-shadow:0 0 0 1px var(--notion-blue)}.error[_ngcontent-%COMP%]{color:var(--notion-red);font-size:12px;margin-top:-12px;font-weight:400}.success-message[_ngcontent-%COMP%]{color:var(--notion-green, #0f7b0f);font-size:13px;padding:8px;background:#0f7b0f14;border-radius:var(--notion-radius);margin:0}.error-message[_ngcontent-%COMP%]{color:var(--notion-red);font-size:13px;margin:0 0 8px;text-align:center;padding:8px;background:var(--notion-red-bg, rgba(235, 87, 87, .1));border-radius:var(--notion-radius);border:1px solid var(--notion-red)}.submit[_ngcontent-%COMP%]{margin-top:0;width:100%;padding:8px 12px;border-radius:var(--notion-radius);border:none;background:var(--notion-text-primary);color:#fff;font-weight:500;font-size:14px;cursor:pointer;transition:background 20ms ease-in 0s}.submit[_ngcontent-%COMP%]:hover{background:#2e2e2c}.submit[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.back-link[_ngcontent-%COMP%]{text-align:center;margin-top:var(--notion-spacing-lg);font-size:14px}.back-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--notion-blue);text-decoration:none}.back-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}@media (max-width: 480px){.auth-page[_ngcontent-%COMP%]{padding:var(--notion-spacing-lg) var(--notion-spacing-sm)}.card[_ngcontent-%COMP%]{padding:var(--notion-spacing)}}"]})}}return e})();export{se as ResetPasswordComponent};
